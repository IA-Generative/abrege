version: 1
disable_existing_loggers: false

formatters:
  json:
    class: pythonjsonlogger.json.JsonFormatter
    format: "%(asctime)s %(levelname)s %(name)s %(pathname)s %(lineno)d %(funcName)s %(message)s"
    rename_fields:
      asctime: "@timestamp"
      levelname: "level"
      pathname: "file_path"
      lineno: "line"
      funcName: "function"
      message: "message"

  standard:
    format: "%(asctime)s [%(levelname)s] %(name)s: %(message)s (%(filename)s:%(lineno)d)"
    datefmt: "%Y-%m-%d %H:%M:%S"

handlers:
  console:
    class: logging.StreamHandler
    level: INFO
    formatter: standard
    stream: ext://sys.stdout

  console_json:
    class: logging.StreamHandler
    level: DEBUG
    formatter: json
    stream: ext://sys.stdout

loggers:
  "":  # root logger
    handlers: [console_json]
    level: INFO
    propagate: false

  abrege:
    handlers: [console_json]
    level: DEBUG
    propagate: false

  abrege_api:
    handlers: [console_json]
    level: DEBUG
    propagate: false

  abrege_worker:
    handlers: [console_json]
    level: DEBUG
    propagate: false

  uvicorn:
    handlers: [console_json]
    level: INFO
    propagate: false

  fastapi:
    handlers: [console_json]
    level: INFO
    propagate: false

# Configuration sp√©cifique par environnement
environments:
  development:
    loggers:
      abrege:
        handlers: [console_json]
        level: DEBUG
      abrege_api:
        handlers: [console_json]
        level: DEBUG
      abrege_worker:
        handlers: [console_json]
        level: DEBUG

  production:
    loggers:
      abrege:
        handlers: [console_json]
        level: INFO
      abrege_api:
        handlers: [console_json]
        level: INFO
      abrege_worker:
        handlers: [console_json]
        level: INFO

  testing:
    loggers:
      abrege:
        handlers: [console_json]
        level: WARNING
      abrege_api:
        handlers: [console_json]
        level: WARNING
      abrege_worker:
        handlers: [console_json]
        level: WARNING
